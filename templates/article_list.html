{% extends 'base.html' %}

{% block title %}Статьи{% endblock title %}

{% block content %}
  <div class="row row-cols-1 row-cols-md-2 g-4">

    {% for article in article_list %}
      <div class="col">
        <div class="card h-100">  <!-- Добавил h-100 для одинаковой высоты -->

      <!-- Заголовок карточки -->
          <div class="card-header">
            <span class="fw-bold">
              <a href="{{ article.get_absolute_url }}" class="text-decoration-none">{{ article.title }}</a>
            </span> &middot;
            <span class="text-muted">
              {{ article.author }} <br> {{ article.date }}
            </span>
          </div>

      <!-- Тело карточки -->
          <div class="card-body">
            <p class="card-text">{{ article.body|truncatewords:30 }}</p>  <!-- Обрезаем длинный текст -->
          </div>

      <!-- Комментарии -->
          <div class="card-footer">
            <h6 class="fw-bold">Комментарии:</h6>
            {% for comment in article.comment_set.all %}
              <p class="mb-1">
                <span class="fw-bold">{{ comment.author }}</span> &middot;
                <span class="text-muted">{{ comment }}</span>
              </p>
            {% empty %}
              <p class="text-muted">Комментариев пока нет</p>
            {% endfor %}
          </div>

      <!-- Кнопки редактирования (только для автора) -->
          {% if article.author.pk == request.user.pk %}
            <div class="card-footer text-center">
              <a class="btn btn-outline-primary btn-sm" href="{% url 'article_edit' article.pk %}">
                <i class="bi bi-pencil"></i> Редактировать
              </a>
              <a class="btn btn-outline-danger btn-sm ms-2" href="{% url 'article_delete' article.pk %}">
                <i class="bi bi-trash"></i> Удалить
              </a>
            </div>
          {% endif %}

        </div>
      </div>
    {% endfor %}

  </div>
{% endblock content %}